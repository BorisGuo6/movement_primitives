stages:
  - test
  - deploy

include:
    - project: 'build_server/gitlab_ci_includes'
      file: 'software_catalogue.yml'

unit_tests:
    image: af01/conda_py38
    stage: test
    before_script:
        - pip install -e .
    script:
        - nosetests -sv test

api_publish:
    image: af01/conda_py38
    stage: deploy
    script:
        - pdoc movement_primitives --html
        - rm -rf /home/www/htdocs/apis/$CI_PROJECT_NAMESPACE/$CI_PROJECT_NAME
        - mkdir -p /home/www/htdocs/apis/$CI_PROJECT_NAMESPACE/$CI_PROJECT_NAME
        - cp -R html/* /home/www/htdocs/apis/$CI_PROJECT_NAMESPACE/$CI_PROJECT_NAME
    artifacts:
        paths:
            - html/
    only:
    - master
